# soa - Structure of Arrays for Go

[![Go Reference](https://pkg.go.dev/badge/github.com/ichiban/soa.svg)](https://pkg.go.dev/github.com/ichiban/soa)

`soa` is an **SoA code generator** and **generic SoA slice library**.

## Code Generator

### Basic Usage

The basic usage is to include the line `//go:generate go run github.com/ichiban/soa/cmd/soagen@latest` in your file with the structs you want to generate SoA slices.

In this example, you can generate a Go source file containing `PointSlice` in `point_soa.go` by executing `go generate ./...`.

`point.go`:

```go
package main

//go:generate go run github.com/ichiban/soa/cmd/soagen@latest

type Point struct {
	X int
	Y int
}
```

`point_soa.go`:

```go
// Code generated by soagen; DO NOT EDIT.
package main

type PointSlice struct {
	X []int
	Y []int
}

// And some methods.
```

### Specify the SoA slice name pattern

You can specify the pattern for the SoA slices with `-name`. It'll replace `{{.}}` with the original struct name.

`point.go`:

```go
package main

//go:generate go run github.com/ichiban/soa/cmd/soagen@latest -name "{{.}}Collection"

type Point struct {
	X int
	Y int
}
```

`point_soa.go`

```go
// Code generated by soagen; DO NOT EDIT.
package main

type PointCollection struct {
	X []int
	Y []int
}

// And some methods.
```

### Specify the output filename

You can specify the output filenames with `-out`.

`point.go`:

```go
package main

//go:generate go run github.com/ichiban/soa/cmd/soagen@latest -out point_gen.go

type Point struct {
	X int
	Y int
}
```

`point_gen.go`:

```go
// Code generated by soagen; DO NOT EDIT.
package main

type PointSlice struct {
	X []int
	Y []int
}

// And some methods.
```

### Specify which structs to be processed

If you list struct names, it'll process listed structs only.

`foo_bar_baz.go`:

```go
package main

//go:generate go run github.com/ichiban/soa/cmd/soagen@latest Foo Baz

type Foo struct {
	X int
	Y int
}

type Bar struct {
	X int
	Y int
}

type Baz struct {
	X int
	Y int
}
```

`foo_bar_baz_soa.go`:

```go
// Code generated by soagen; DO NOT EDIT.
package main

type FooSlice struct {
	X []int
	Y []int
}

// And some methods.

type BazSlice struct {
	X []int
	Y []int
}

// And some methods.
```

## Library

You can manipulate SoA slices with [the library `github.com/ichiban/soa`](https://pkg.go.dev/github.com/ichiban/soa).

It implements [`slices`-compatible functions](https://pkg.go.dev/slices).

## License

Distributed under the MIT license. See `LICENSE` for more information.

## Contributing

1. Fork it (https://github.com/ichiban/soa/fork)
2. Create your feature branch (git checkout -b feature/fooBar)
3. Commit your changes (git commit -am 'Add some fooBar')
4. Push to the branch (git push origin feature/fooBar)
5. Create a new Pull Request
